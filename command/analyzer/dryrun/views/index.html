<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>{{ .PageTitle }}</title>
    <link href="static/style.css" type="text/css" rel="stylesheet" />
    <style>
      body,
      html {
        width: 100%;
        height: 100%;
        margin: 0;
      }

      .container {
        width: 100%;
        height: 100%;
      }

      .leftpane {
        width: 25%;
        height: 100%;
        float: left;
        border-collapse: collapse;
      }

      .run-summary {
        width: 25%;
        height: 100%;
        bottom: 100px;
        border-collapse: collapse;
      }

      .middlepane {
        width: 50%;
        height: 100%;
        float: left;
        border-collapse: collapse;
      }

      .rightpane {
        width: 25%;
        height: 100%;
        position: relative;
        float: right;
        border-collapse: collapse;
      }

      .toppane {
        width: 100%;
        height: 100px;
        border-collapse: collapse;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="toppane">
        {{ .AnalyzerShortcode }}<br>
        {{ .AnalysisResultData.UniqueIssuesCount }} issues {{ .VCSInfo.Branch }} {{ .VCSInfo.CommitSHA }} {{ .VCSInfo.VersionDiff }}
      </div>

        <!-- Category Section -->
      <div class="leftpane">
        <p>
          <a href="/issues"><strong>All Issues</strong></a>&nbsp;&nbsp;{{ .AnalysisResultData.TotalOccurences }}<br>
          {{ $categoryMap := .IssueCategoryNameMap}}
          {{ range $key, $value := .AnalysisResultData.IssueCategoryCountMap }}
          {{ $categoryShortCode := (index $categoryMap $key) }}
          <li><strong><a href="/issues?category={{$categoryShortCode}}">{{ $key }}</a></strong>: {{ $value }}</li>
          {{ end }}
        </p>

        <!-- Run Summary Section -->
      <div class="run-summary">
        <p>Run Summary</p>
        {{ .Summary.TimeSinceRun }}<br>
        {{ .AnalysisResultData.SourcePath }}<br>
        {{ .Summary.RunDuration}}
      </div>
      </div>


        <!-- All Unique Issues Section -->
      <div class="middlepane">
        <p>
        {{ range $index, $error := .AnalysisResultData.AnalysisResult.Errors }}
          {{ if eq $error.Level 0}}
            <strong>Error</strong>&nbsp;{{ $error.HMessage }}
          {{ else }}{{ if eq $error.Level 1}}
            <strong>Warning</strong>&nbsp;{{ $error.HMessage }}
            {{ end }}{{ end }}
        {{ end }}
        </p>
        <p>
          {{ $defaultIssueCategory := "all"}}
          {{ $selectedCategory := .SelectedCategory }}
          {{ range $key, $value := .AnalysisResultData.IssuesOccurenceMap }}
            {{ if eq $selectedCategory $defaultIssueCategory }}
              <a href="/issue/{{ $key }}/occurences"><strong>{{ $value.IssueMeta.Title }}</strong></a>&nbsp;{{ $key }}&nbsp;{{ len  $value.Occurences }}<br>
              {{ $value.IssueMeta.Category }}&nbsp;&nbsp;{{ $value.FilesInfo }}<br>
            {{else }} {{ if eq $selectedCategory $value.IssueMeta.Category }}
              <a href="/issue/{{ $key }}/occurences"><strong>{{ $value.IssueMeta.Title }}</strong></a>&nbsp;{{ $key }}&nbsp;{{ len  $value.Occurences }}<br>
              {{ $value.IssueMeta.Category }}&nbsp;&nbsp;{{ $value.FilesInfo }}<br>
              {{ end}}
            {{end}}
          {{ end }}
        </p>
      </div>
        <!-- Metrics Section -->
      <div class="rightpane">
        <p>
          <strong>Metrics</strong><br>
          {{ range $name, $metric := .AnalysisResultData.MetricsMap }}
          <strong>{{ $name }}</strong>:&nbsp;{{ $metric }}<br>
          {{ end }}
        </p>
      </div>
    </div>
  </body>
</html>
